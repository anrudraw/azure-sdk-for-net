parameters:
- name: Platforms
  type: object
  default: []
- name: CloudConfig
  type: object
  default: []
- name: AdditionalParameters
  type: object
  default: []

jobs:
- template: ./archetype-sdk-tests-jobs.yml
  parameters:
    Platforms:
      ${{ each platform in parameters.Platforms }}:
        ${{ if contains(cloud.key, coalesce(platform.value.SupportedClouds, join(',', parameters.CloudConfig))) }}:
          ${{ platform.key }}: ${{ platform.value }}
    CloudConfig: ${{ parameters.CloudConfig }}
    ${{ each param in parameters.AdditionalParameters }}:
      ${{ param.key }}: ${{ param.value }}
